<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Orçamento #{{ orc.id }} — {{ os_row.os_code }}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="icon" href="/favicon.ico">
  <style>
    :root{--brand:#ee6b2f;}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#f6f7fb;color:#0f172a}
    .wrap{max-width:920px;margin:26px auto;padding:0 14px}
    .hero{background:var(--brand);color:#fff;border-radius:16px;padding:18px 20px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 8px 30px rgba(238,107,47,.25)}
    .hero h1{margin:0;font-size:22px}
    .card{background:#fff;border-radius:16px;padding:18px 18px;box-shadow:0 2px 10px rgba(0,0,0,.06);margin-top:16px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .grid .cell{background:#fafafa;border:1px solid #e5e7eb;border-radius:12px;padding:10px}
    table{width:100%;border-collapse:separate;border-spacing:0;margin-top:8px}
    th,td{padding:10px;border-bottom:1px solid #f1f5f9}
    th{text-align:left;background:#f9fafb;font-weight:700}
    .total{font-size:26px;font-weight:900}
    .actions{display:flex;gap:10px;margin-top:14px}
    .btn{border:0;border-radius:10px;padding:10px 14px;cursor:pointer}
    .btn-primary{background:#16a34a;color:#fff}
    .btn-secondary{background:#eef2ff;color:#1e293b}
    .note{color:#475569;font-size:13px;margin-top:10px}
    .approved{background:#dcfce7;color:#166534;border:1px solid #bbf7d0;border-radius:12px;padding:10px;margin-top:10px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <h1>Orçamento #{{ orc.id }} · {{ os_row.os_code }}</h1>
      <div>Cliente: <b>{{ os_row.cliente }}</b></div>
    </div>

    <div class="card">
      <div class="grid">
        <div class="cell"><b>Status</b><br>{{ orc.status }}</div>
        <div class="cell"><b>Data</b><br>{{ orc.created_at or '-' }}</div>
      </div>

      <h3 style="margin:18px 0 8px">Itens</h3>
      <table>
        <thead><tr><th>Descrição</th><th style="width:90px">Qtd</th><th style="width:140px">Preço</th><th style="width:140px">Total</th></tr></thead>
        <tbody>
          {% for it in itens %}
            <tr>
              <td>{{ it.descricao }}</td>
              <td>{{ it.qtd }}</td>
              <td>{{ money(it.preco_unit) }}</td>
              <td><b>{{ money(it.total) }}</b></td>
            </tr>
          {% else %}
            <tr><td colspan="4">Sem itens.</td></tr>
          {% endfor %}
        </tbody>
      </table>

      <div style="text-align:right;margin-top:10px">
        <div>Subtotal: <b>{{ money(orc.subtotal) }}</b></div>
        <div>Desconto: <b>{{ money(orc.desconto) }}</b></div>
        <div class="total">Total: {{ money(orc.total) }}</div>
      </div>

      {% if orc.approved_at %}
        <div class="approved">Aprovado em {{ orc.approved_at }} (IP {{ orc.approved_ip }})</div>
      {% else %}
        <form class="actions" method="post" action="/o/{{ orc.token_publico }}/aprovar" onsubmit="return confirm('Confirmar aprovação?')">
          <button class="btn btn-primary" type="submit">Aprovar orçamento</button>
          <a class="btn btn-secondary" href="/orcamentos/pdf/{{ orc.id }}" target="_blank">Baixar PDF</a>
        </form>
        <div class="note">Ao aprovar, você concorda com os valores acima e autoriza o início do serviço.</div>
      {% endif %}
    </div>
  </div>
</body>
</html>
